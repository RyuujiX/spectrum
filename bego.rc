# kernel manaeger,inspired from SPECTRUM KERNEL MANAGER
# by ZyCromerZ @ 2020

# Initialization
on property:sys.boot_completed=1
    setprop spectrum.support 1
    setprop sys.display-size 3840x2160
    setprop persist.spectrum.kernel kernelname
    # set to balance
on property:sys.post_boot.parsed=1
    setprop vendor.post_boot.parsed 1

on property:vendor.post_boot.parsed=1
    setprop sys.display-size 3840x2160
    # for set mode spectrum
    setprop persist.spectrum.profile 0
    # tweak thermal
    chmod 0644 /sys/class/thermal/thermal_message/sconfig
    write /sys/class/thermal/thermal_message/sconfig 10
    chmod 0444 /sys/class/thermal/thermal_message/sconfig

# Battery
on property:persist.spectrum.profile=2
    # CPU TWEAK
    write /sys/devices/system/cpu/cpufreq/policy0/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/policy6/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 500
    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 80000
    # scheduler TWEAK
    write /sys/block/mmcblk0/queue/scheduler anxiety
    write /sys/block/mmcblk0/queue/read_ahead 1024
    write /sys/block/mmcblk0/queue/nr_request 512
    write /sys/block/mmcblk0/queue/rq_affinity 1
    write /sys/block/mmcblk0/queue/add_random 1
    write /sys/block/mmcblk0/queue/rational 1
    write /sys/block/sda/queue/scheduler anxiety
    write /sys/block/sda/queue/read_ahead 1024
    write /sys/block/sda/queue/nr_request 512
    write /sys/block/sda/queue/rq_affinity 1
    write /sys/block/sda/queue/add_random 1
    write /sys/block/sda/queue/rational 1
    write /sys/block/sdb/queue/scheduler anxiety
    write /sys/block/sdb/queue/read_ahead 1024
    write /sys/block/sdb/queue/nr_request 512
    write /sys/block/sdb/queue/rq_affinity 1
    write /sys/block/sdb/queue/add_random 1
    write /sys/block/sdb/queue/rational 1
    write /sys/block/sdc/queue/scheduler anxiety
    write /sys/block/sdc/queue/read_ahead 1024
    write /sys/block/sdc/queue/nr_request 512
    write /sys/block/sdc/queue/rq_affinity 1
    write /sys/block/sdc/queue/add_random 1
    write /sys/block/sdc/queue/rational 1
    # tweak thermal
    chmod 0644 /sys/class/thermal/thermal_message/sconfig
    write /sys/class/thermal/thermal_message/sconfig 10
    chmod 0444 /sys/class/thermal/thermal_message/sconfig

# balance
on property:persist.spectrum.profile=0
    # CPU TWEAK
    write /sys/devices/system/cpu/cpufreq/policy0/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/policy6/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 10000
    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 10000
    # scheduler TWEAK
    write /sys/block/mmcblk0/queue/scheduler cfq
    write /sys/block/mmcblk0/queue/read_ahead 2048
    write /sys/block/mmcblk0/queue/nr_request 1024
    write /sys/block/mmcblk0/queue/rq_affinity 1
    write /sys/block/mmcblk0/queue/add_random 1
    write /sys/block/mmcblk0/queue/rational 0
    write /sys/block/sda/queue/scheduler cfq
    write /sys/block/sda/queue/read_ahead 2048
    write /sys/block/sda/queue/nr_request 1024
    write /sys/block/sda/queue/rq_affinity 1
    write /sys/block/sda/queue/add_random 1
    write /sys/block/sda/queue/rational 0
    write /sys/block/sdb/queue/scheduler cfq
    write /sys/block/sdb/queue/read_ahead 2048
    write /sys/block/sdb/queue/nr_request 1024
    write /sys/block/sdb/queue/rq_affinity 1
    write /sys/block/sdb/queue/add_random 1
    write /sys/block/sdb/queue/rational 0
    write /sys/block/sdc/queue/scheduler cfq
    write /sys/block/sdc/queue/read_ahead 2048
    write /sys/block/sdc/queue/nr_request 1024
    write /sys/block/sdc/queue/rq_affinity 1
    write /sys/block/sdc/queue/add_random 1
    write /sys/block/sdc/queue/rational 0
    # tweak thermal
    chmod 0644 /sys/class/thermal/thermal_message/sconfig
    write /sys/class/thermal/thermal_message/sconfig 10
    chmod 0444 /sys/class/thermal/thermal_message/sconfig

# Gaming
on property:persist.spectrum.profile=3
    # CPU TWEAK
    write /sys/devices/system/cpu/cpufreq/policy0/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/policy6/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 900000
    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 100
    # scheduler TWEAK
    write /sys/block/mmcblk0/queue/scheduler deadline
    write /sys/block/mmcblk0/queue/read_ahead 4096
    write /sys/block/mmcblk0/queue/nr_request 2048
    write /sys/block/mmcblk0/queue/rq_affinity 2
    write /sys/block/mmcblk0/queue/add_random 0
    write /sys/block/mmcblk0/queue/rational 0
    write /sys/block/sda/queue/scheduler deadline
    write /sys/block/sda/queue/read_ahead 4096
    write /sys/block/sda/queue/nr_request 2048
    write /sys/block/sda/queue/rq_affinity 2
    write /sys/block/sda/queue/add_random 0
    write /sys/block/sda/queue/rational 0
    write /sys/block/sdb/queue/scheduler deadline
    write /sys/block/sdb/queue/read_ahead 4096
    write /sys/block/sdb/queue/nr_request 2048
    write /sys/block/sdb/queue/rq_affinity 2
    write /sys/block/sdb/queue/add_random 0
    write /sys/block/sdb/queue/rational 0
    write /sys/block/sdc/queue/scheduler deadline
    write /sys/block/sdc/queue/read_ahead 4096
    write /sys/block/sdc/queue/nr_request 2048
    write /sys/block/sdc/queue/rq_affinity 2
    write /sys/block/sdc/queue/add_random 0
    write /sys/block/sdc/queue/rational 0
    # tweak thermal
    chmod 0644 /sys/class/thermal/thermal_message/sconfig
    write /sys/class/thermal/thermal_message/sconfig "-1"
    chmod 0444 /sys/class/thermal/thermal_message/sconfig

# Performance
on property:persist.spectrum.profile=1
    # CPU TWEAK
    write /sys/devices/system/cpu/cpufreq/policy0/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/policy6/scaling_governor schedutil
    write /sys/devices/system/cpu/cpufreq/schedutil/down_rate_limit_us 900000
    write /sys/devices/system/cpu/cpufreq/schedutil/up_rate_limit_us 500
    # scheduler TWEAK
    write /sys/block/mmcblk0/queue/scheduler deadline
    write /sys/block/mmcblk0/queue/read_ahead 4096
    write /sys/block/mmcblk0/queue/nr_request 2048
    write /sys/block/mmcblk0/queue/rq_affinity 1
    write /sys/block/mmcblk0/queue/add_random 0
    write /sys/block/mmcblk0/queue/rational 0
    write /sys/block/sda/queue/scheduler deadline
    write /sys/block/sda/queue/read_ahead 4096
    write /sys/block/sda/queue/nr_request 2048
    write /sys/block/sda/queue/rq_affinity 1
    write /sys/block/sda/queue/add_random 0
    write /sys/block/sda/queue/rational 0
    write /sys/block/sdb/queue/scheduler deadline
    write /sys/block/sdb/queue/read_ahead 4096
    write /sys/block/sdb/queue/nr_request 2048
    write /sys/block/sdb/queue/rq_affinity 1
    write /sys/block/sdb/queue/add_random 0
    write /sys/block/sdb/queue/rational 0
    write /sys/block/sdc/queue/scheduler deadline
    write /sys/block/sdc/queue/read_ahead 4096
    write /sys/block/sdc/queue/nr_request 2048
    write /sys/block/sdc/queue/rq_affinity 1
    write /sys/block/sdc/queue/add_random 0
    write /sys/block/sdc/queue/rational 0
    # tweak thermal
    chmod 0644 /sys/class/thermal/thermal_message/sconfig
    write /sys/class/thermal/thermal_message/sconfig 13
    chmod 0444 /sys/class/thermal/thermal_message/sconfig